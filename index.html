<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brahmastra Arts & Sports Club - Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1810 100%);
            min-height: 100vh;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #ff6b00 0%, #ff8c00 100%);
        }
        
        .glass-effect {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 107, 0, 0.2);
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-in {
            animation: slideIn 0.6s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .btn-hover {
            transition: all 0.3s ease;
        }
        
        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 107, 0, 0.4);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 107, 0, 0.3);
        }
        
        .input-focus {
            transition: all 0.3s ease;
        }
        
        .input-focus:focus {
            border-color: #ff6b00;
            box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.1);
        }
        
        .logo-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .sidebar {
            transition: all 0.3s ease;
        }
        
        .sidebar-item {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .sidebar-item:hover {
            background: rgba(255, 107, 0, 0.1);
            border-left: 4px solid #ff6b00;
        }
        
        .sidebar-item.active {
            background: rgba(255, 107, 0, 0.2);
            border-left: 4px solid #ff6b00;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        .modal.show {
            display: flex;
        }
        
        .status-paid {
            background: #065f46;
            color: #6ee7b7;
        }
        
        .status-unpaid {
            background: #7f1d1d;
            color: #fca5a5;
        }
        
        .table-row {
            transition: all 0.2s ease;
        }
        
        .table-row:hover {
            background: rgba(255, 107, 0, 0.05);
        }
        
        .hidden {
            display: none !important;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 999;
                height: 100vh;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-md fade-in">
            <div class="text-center mb-8 slide-in">
                <div class="inline-block p-4 rounded-full gradient-bg logo-pulse mb-4">
                    <svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                </div>
                <h1 class="text-3xl font-bold text-white mb-2">Brahmastra Arts & Sports Club</h1>
                <p class="text-orange-400 text-sm">Vakkom | Member Portal</p>
            </div>

            <div class="glass-effect rounded-2xl p-8 shadow-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 text-center">Welcome Back</h2>
                
                <form id="loginForm" class="space-y-6">
                    <div>
                        <label for="userId" class="block text-sm font-medium text-gray-300 mb-2">User ID</label>
                        <input type="text" id="userId" required class="input-focus w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none" placeholder="Enter your User ID">
                    </div>

                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                        <input type="password" id="password" required class="input-focus w-full px-4 py-3 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none" placeholder="Enter your password">
                    </div>

                    <div id="loginError" class="hidden bg-red-900/50 border border-red-500 text-red-200 px-4 py-3 rounded-lg text-sm"></div>

                    <button type="submit" class="btn-hover w-full gradient-bg text-white font-semibold py-3 rounded-lg focus:outline-none">Login</button>
                </form>

                <div class="mt-6 text-center">
                    <p class="text-gray-400 text-sm"> <span class="text-orange-400 font-semibold"></span></p>
                </div>
            </div>

            <div class="text-center mt-6 text-gray-500 text-sm">
                <p>&copy; 2024 Brahmastra Arts & Sports Club. All rights reserved.</p>
            </div>
        </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="adminDashboard" class="hidden min-h-screen">
        <div class="flex">
            <!-- Sidebar -->
            <aside id="sidebar" class="sidebar w-64 glass-effect p-6 flex flex-col">
                <div class="mb-8">
                    <div class="flex items-center space-x-3">
                        <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                            </svg>
                        </div>
                        <div>
                            <h2 class="text-white font-bold text-lg">Brahmastra</h2>
                            <p class="text-orange-400 text-xs">Admin Panel</p>
                        </div>
                    </div>
                </div>

                <nav class="flex-1 space-y-2">
                    <div class="sidebar-item active" data-section="dashboard">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                            <span>Dashboard</span>
                        </div>
                    </div>
                    
                    <div class="sidebar-item" data-section="members">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                            <span>Members</span>
                        </div>
                    </div>
                    
                    <div class="sidebar-item" data-section="payments">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                            <span>Payments</span>
                        </div>
                    </div>
                    
                    <div class="sidebar-item" data-section="expenses">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                            <span>Expenses</span>
                        </div>
                    </div>
                    
                    <div class="sidebar-item" data-section="reports">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            <span>Reports</span>
                        </div>
                    </div>
                </nav>

                <div class="space-y-2 pt-4 border-t border-gray-700">
                    <div class="sidebar-item" data-section="settings">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                            <span>Settings</span>
                        </div>
                    </div>
                    
                    <div class="sidebar-item" id="logoutBtn">
                        <div class="flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                            <span>Logout</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 p-6 overflow-y-auto">
                <!-- Header -->
                <header class="glass-effect rounded-lg p-4 mb-6 flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <button id="menuToggle" class="md:hidden text-white">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                        </button>
                        <div>
                            <h1 class="text-2xl font-bold text-white">Admin Dashboard</h1>
                            <p class="text-gray-400 text-sm">Welcome back, <span id="adminName">Admin</span></p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-white font-semibold" id="currentDate"></p>
                        <p class="text-orange-400 text-sm" id="currentTime"></p>
                    </div>
                </header>

                <!-- Dashboard Section -->
                <div id="dashboardSection" class="content-section">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                        <div class="glass-effect rounded-lg p-6 card-hover">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Total Members</p>
                                    <h3 class="text-3xl font-bold text-white mt-2" id="totalMembers">0</h3>
                                </div>
                                <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                                </div>
                            </div>
                        </div>

                        <div class="glass-effect rounded-lg p-6 card-hover">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Monthly Collection</p>
                                    <h3 class="text-3xl font-bold text-green-400 mt-2">₹<span id="monthlyCollection">0</span></h3>
                                </div>
                                <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                </div>
                            </div>
                        </div>

                        <div class="glass-effect rounded-lg p-6 card-hover">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Monthly Expenses</p>
                                    <h3 class="text-3xl font-bold text-red-400 mt-2">₹<span id="monthlyExpenses">0</span></h3>
                                </div>
                                <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                                </div>
                            </div>
                        </div>

                        <div class="glass-effect rounded-lg p-6 card-hover">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-400 text-sm">Net Balance</p>
                                    <h3 class="text-3xl font-bold text-orange-400 mt-2">₹<span id="netBalance">0</span></h3>
                                </div>
                                <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="glass-effect rounded-lg p-6">
                            <h3 class="text-xl font-bold text-white mb-4">Monthly Collections</h3>
                            <canvas id="collectionChart"></canvas>
                        </div>
                        <div class="glass-effect rounded-lg p-6">
                            <h3 class="text-xl font-bold text-white mb-4">Monthly Expenses</h3>
                            <canvas id="expenseChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Members Section -->
                <div id="membersSection" class="content-section hidden">
                    <div class="glass-effect rounded-lg p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Manage Members</h2>
                            <button id="addMemberBtn" class="btn-hover gradient-bg px-6 py-2 rounded-lg text-white font-semibold">+ Add Member</button>
                        </div>

                        <div class="mb-4">
                            <input type="text" id="searchMember" placeholder="Search members..." class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-orange-500">
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Member ID</th>
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Name</th>
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Role</th>
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Joined</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="membersTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Payments Section -->
                <div id="paymentsSection" class="content-section hidden">
                    <div class="glass-effect rounded-lg p-6">
                        <h2 class="text-2xl font-bold text-white mb-6">Mark Monthly Payments</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block text-gray-400 mb-2">Select Month</label>
                                <select id="paymentMonth" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500">
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-400 mb-2">Select Year</label>
                                <select id="paymentYear" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500"></select>
                            </div>
                        </div>

                        <div class="mb-4 flex justify-between items-center flex-wrap gap-2">
                            <div class="flex items-center space-x-4">
                                <button id="markAllPaidBtn" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-white">Mark All Paid</button>
                                <button id="markAllUnpaidBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg text-white">Mark All Unpaid</button>
                            </div>
                            <button id="savePaymentsBtn" class="btn-hover gradient-bg px-6 py-2 rounded-lg text-white font-semibold">Save Changes</button>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Member ID</th>
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Name</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Amount</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="paymentsTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Expenses Section -->
                <div id="expensesSection" class="content-section hidden">
                    <div class="glass-effect rounded-lg p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Manage Monthly Expenses</h2>
                            <button id="addExpenseBtn" class="btn-hover gradient-bg px-6 py-2 rounded-lg text-white font-semibold">+ Add Expense</button>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-700">
                                        <th class="text-left py-3 px-4 text-gray-400 font-semibold">Month/Year</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Electricity</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Internet</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Miscellaneous</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Total</th>
                                        <th class="text-center py-3 px-4 text-gray-400 font-semibold">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="expensesTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Reports Section -->
                <div id="reportsSection" class="content-section hidden">
                    <div class="glass-effect rounded-lg p-6">
                        <h2 class="text-2xl font-bold text-white mb-6">Generate Reports</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label class="block text-gray-400 mb-2">Select Month</label>
                                <select id="reportMonth" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500">
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-400 mb-2">Select Year</label>
                                <select id="reportYear" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500"></select>
                            </div>
                        </div>

                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-white mb-4">Financial Summary Report</h3>
                            <div class="flex space-x-4 flex-wrap gap-2">
                                <button id="viewReportBtn" class="btn-hover gradient-bg px-6 py-2 rounded-lg text-white font-semibold">View Summary</button>
                                <button id="downloadReportBtn" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg text-white font-semibold">Download PDF</button>
                            </div>
                        </div>

                        <div id="reportContent" class="glass-effect rounded-lg p-6 hidden mb-6"></div>

                        <div class="glass-effect rounded-lg p-6 mb-6">
                            <h3 class="text-lg font-semibold text-white mb-4">All Members Payment Report</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <div>
                                    <label class="block text-gray-400 mb-2">Select Month</label>
                                    <select id="membersReportMonth" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500">
                                        <option value="1">January</option>
                                        <option value="2">February</option>
                                        <option value="3">March</option>
                                        <option value="4">April</option>
                                        <option value="5">May</option>
                                        <option value="6">June</option>
                                        <option value="7">July</option>
                                        <option value="8">August</option>
                                        <option value="9">September</option>
                                        <option value="10">October</option>
                                        <option value="11">November</option>
                                        <option value="12">December</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-400 mb-2">Select Year</label>
                                    <select id="membersReportYear" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500"></select>
                                </div>
                                <div class="flex items-end">
                                    <button id="printMembersReportBtn" class="w-full bg-purple-600 hover:bg-purple-700 px-6 py-2 rounded-lg text-white font-semibold">Generate Report</button>
                                </div>
                            </div>
                        </div>

                        <div id="membersReportContent" class="glass-effect rounded-lg p-6 hidden"></div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settingsSection" class="content-section hidden">
                    <div class="glass-effect rounded-lg p-6">
                        <h2 class="text-2xl font-bold text-white mb-6">Settings</h2>
                        
                        <div class="max-w-md">
                            <h3 class="text-lg font-semibold text-white mb-4">Change Password</h3>
                            <form id="changePasswordForm" class="space-y-4">
                                <div>
                                    <label class="block text-gray-400 mb-2">Current Password</label>
                                    <input type="password" id="currentPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                                </div>
                                <div>
                                    <label class="block text-gray-400 mb-2">New Password</label>
                                    <input type="password" id="newPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                                </div>
                                <div>
                                    <label class="block text-gray-400 mb-2">Confirm New Password</label>
                                    <input type="password" id="confirmPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                                </div>
                                <button type="submit" class="btn-hover gradient-bg px-6 py-2 rounded-lg text-white font-semibold">Update Password</button>
                            </form>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- MEMBER DASHBOARD -->
    <div id="memberDashboard" class="hidden min-h-screen p-4 md:p-8">
        <div class="max-w-7xl mx-auto fade-in">
            <header class="glass-effect rounded-lg p-6 mb-6 flex justify-between items-center flex-wrap gap-4">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white">Welcome, <span id="memberName">Member</span></h1>
                        <p class="text-gray-400 text-sm">Member ID: <span id="memberIdDisplay"></span></p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="memberSettingsBtn" class="text-white hover:text-orange-400 transition">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                    </button>
                    <button id="memberLogoutBtn" class="btn-hover gradient-bg px-4 py-2 rounded-lg text-white font-semibold">Logout</button>
                </div>
            </header>

            <div class="glass-effect rounded-lg p-6 mb-6">
                <div class="flex items-center justify-between flex-wrap gap-4">
                    <div class="flex items-center space-x-4">
                        <div class="w-16 h-16 gradient-bg rounded-full flex items-center justify-center">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-white">Brahmastra Arts & Sports Club</h2>
                            <p class="text-orange-400">Vakkom, Kerala</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-gray-400 text-sm">Monthly Fee</p>
                        <p class="text-2xl font-bold text-green-400">₹100</p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div class="glass-effect rounded-lg p-6 card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Total Paid</p>
                            <h3 class="text-3xl font-bold text-green-400 mt-2" id="memberTotalPaid">₹0</h3>
                        </div>
                        <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                    </div>
                </div>

                <div class="glass-effect rounded-lg p-6 card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Pending Dues</p>
                            <h3 class="text-3xl font-bold text-red-400 mt-2" id="memberPendingDues">₹0</h3>
                        </div>
                        <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                    </div>
                </div>

                <div class="glass-effect rounded-lg p-6 card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">Current Status</p>
                            <h3 class="text-2xl font-bold text-orange-400 mt-2" id="memberStatus">Active</h3>
                        </div>
                        <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="glass-effect rounded-lg p-6 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white">Payment History</h2>
                    <select id="memberFilterYear" class="px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500"></select>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-gray-700">
                                <th class="text-left py-3 px-4 text-gray-400 font-semibold">Month</th>
                                <th class="text-left py-3 px-4 text-gray-400 font-semibold">Year</th>
                                <th class="text-center py-3 px-4 text-gray-400 font-semibold">Amount</th>
                                <th class="text-center py-3 px-4 text-gray-400 font-semibold">Status</th>
                                <th class="text-center py-3 px-4 text-gray-400 font-semibold">Date</th>
                            </tr>
                        </thead>
                        <tbody id="memberPaymentHistoryBody"></tbody>
                    </table>
                </div>
            </div>

            <div class="glass-effect rounded-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white">Monthly Expenses</h2>
                    <select id="memberExpenseFilterYear" class="px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500"></select>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="memberExpensesContainer"></div>
            </div>
        </div>
    </div>

    <!-- Add Member Modal -->
    <div id="addMemberModal" class="modal justify-center items-center">
        <div class="glass-effect rounded-lg p-8 w-full max-w-md m-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white">Add New Member</h3>
                <button class="close-modal text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="addMemberForm" class="space-y-4">
                <div>
                    <label class="block text-gray-400 mb-2">Member ID</label>
                    <input type="text" id="newMemberId" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Member Name</label>
                    <input type="text" id="newMemberName" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Password</label>
                    <input type="password" id="newMemberPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Role</label>
                    <select id="newMemberRole" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500">
                        <option value="member">Member</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="flex space-x-4 pt-4">
                    <button type="submit" class="btn-hover gradient-bg flex-1 py-2 rounded-lg text-white font-semibold">Add Member</button>
                    <button type="button" class="close-modal bg-gray-700 hover:bg-gray-600 flex-1 py-2 rounded-lg text-white font-semibold">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div id="addExpenseModal" class="modal justify-center items-center">
        <div class="glass-effect rounded-lg p-8 w-full max-w-md m-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white">Add Monthly Expense</h3>
                <button class="close-modal text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="addExpenseForm" class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-400 mb-2">Month</label>
                        <select id="expenseMonth" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-400 mb-2">Year</label>
                        <select id="expenseYear" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required></select>
                    </div>
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Electricity Bill (₹)</label>
                    <input type="number" id="electricityBill" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" min="0" value="0">
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Internet Bill (₹)</label>
                    <input type="number" id="internetBill" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" min="0" value="0">
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Miscellaneous (₹)</label>
                    <input type="number" id="miscellaneousBill" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" min="0" value="0">
                </div>
                <div class="flex space-x-4 pt-4">
                    <button type="submit" class="btn-hover gradient-bg flex-1 py-2 rounded-lg text-white font-semibold">Add Expense</button>
                    <button type="button" class="close-modal bg-gray-700 hover:bg-gray-600 flex-1 py-2 rounded-lg text-white font-semibold">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Member Settings Modal -->
    <div id="memberSettingsModal" class="modal justify-center items-center">
        <div class="glass-effect rounded-lg p-8 w-full max-w-md m-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white">Change Password</h3>
                <button id="closeMemberSettingsBtn" class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="memberChangePasswordForm" class="space-y-4">
                <div>
                    <label class="block text-gray-400 mb-2">Current Password</label>
                    <input type="password" id="memberCurrentPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">New Password</label>
                    <input type="password" id="memberNewPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                </div>
                <div>
                    <label class="block text-gray-400 mb-2">Confirm New Password</label>
                    <input type="password" id="memberConfirmPassword" class="w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-orange-500" required>
                </div>
                <button type="submit" class="w-full gradient-bg text-white font-semibold py-3 rounded-lg hover:opacity-90 transition">Update Password</button>
            </form>
        </div>
    </div>

    <script>
        // ==================== DATA STRUCTURE & INITIALIZATION ====================
        
        const STORAGE_KEYS = {
            MEMBERS: 'brahmastra_members',
            EXPENSES: 'brahmastra_expenses',
            CURRENT_USER: 'brahmastra_current_user'
        };

        // Initialize default admin and sample data
        function initializeDefaultData() {
            let members = getMembers();
            if (members.length === 0) {
                members = [
                    {
                        memberId: 'brahmastra01',
                        memberName: 'Admin User',
                        password: 'Accen@10090', // In production, this should be hashed
                        role: 'admin',
                        monthlyPayments: [],
                        createdAt: new Date().toISOString()
                    }
                ];
                localStorage.setItem(STORAGE_KEYS.MEMBERS, JSON.stringify(members));
            }

            let expenses = getExpenses();
            if (expenses.length === 0) {
                expenses = [];
                localStorage.setItem(STORAGE_KEYS.EXPENSES, JSON.stringify(expenses));
            }
        }

        // ==================== STORAGE FUNCTIONS ====================
        
        function getMembers() {
            const data = localStorage.getItem(STORAGE_KEYS.MEMBERS);
            return data ? JSON.parse(data) : [];
        }

        function setMembers(members) {
            localStorage.setItem(STORAGE_KEYS.MEMBERS, JSON.stringify(members));
        }

        function getExpenses() {
            const data = localStorage.getItem(STORAGE_KEYS.EXPENSES);
            return data ? JSON.parse(data) : [];
        }

        function setExpenses(expenses) {
            localStorage.setItem(STORAGE_KEYS.EXPENSES, JSON.stringify(expenses));
        }

        function getCurrentUser() {
            const data = localStorage.getItem(STORAGE_KEYS.CURRENT_USER);
            return data ? JSON.parse(data) : null;
        }

        function setCurrentUser(user) {
            if (user) {
                localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(user));
            } else {
                localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
            }
        }

        // ==================== AUTHENTICATION ====================
        
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const userId = document.getElementById('userId').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('loginError');
            
            errorDiv.classList.add('hidden');

            const members = getMembers();
            const member = members.find(m => m.memberId === userId && m.password === password);

            if (member) {
                setCurrentUser({
                    memberId: member.memberId,
                    memberName: member.memberName,
                    role: member.role
                });

                document.getElementById('loginPage').classList.add('hidden');
                
                if (member.role === 'admin') {
                    document.getElementById('adminDashboard').classList.remove('hidden');
                    initAdminDashboard();
                } else {
                    document.getElementById('memberDashboard').classList.remove('hidden');
                    initMemberDashboard();
                }
            } else {
                errorDiv.textContent = 'Invalid credentials';
                errorDiv.classList.remove('hidden');
            }
        });

        // Logout functions
        document.getElementById('logoutBtn').addEventListener('click', logout);
        document.getElementById('memberLogoutBtn').addEventListener('click', logout);

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                setCurrentUser(null);
                location.reload();
            }
        }

        // ==================== UTILITY FUNCTIONS ====================
        
        function updateDateTime() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateElement = document.getElementById('currentDate');
            const timeElement = document.getElementById('currentTime');
            if (dateElement) dateElement.textContent = now.toLocaleDateString('en-US', options);
            if (timeElement) timeElement.textContent = now.toLocaleTimeString('en-US');
        }

        function populateYears() {
            const currentYear = new Date().getFullYear();
            const yearSelects = ['paymentYear', 'expenseYear', 'reportYear', 'memberFilterYear', 'memberExpenseFilterYear', 'membersReportYear'];
            
            yearSelects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '';
                    for (let year = 2024; year <= currentYear + 1; year++) {
                        const option = document.createElement('option');
                        option.value = year;
                        option.textContent = year;
                        if (year === currentYear) option.selected = true;
                        select.appendChild(option);
                    }
                }
            });

            // Set current month for members report
            const now = new Date();
            const membersReportMonth = document.getElementById('membersReportMonth');
            if (membersReportMonth) {
                membersReportMonth.value = now.getMonth() + 1;
            }
        }

        const monthNames = ['', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

        // ==================== ADMIN DASHBOARD ====================
        
        let collectionChart, expenseChart;

        function initAdminDashboard() {
            const user = getCurrentUser();
            document.getElementById('adminName').textContent = user.memberName;
            
            populateYears();
            updateDateTime();
            setInterval(updateDateTime, 1000);

            const now = new Date();
            const currentMonth = now.getMonth() + 1;
            const currentYear = now.getFullYear();
            
            document.getElementById('paymentMonth').value = currentMonth;
            document.getElementById('reportMonth').value = currentMonth;

            loadDashboardStats();
            setupAdminEventListeners();
        }

        function loadDashboardStats() {
            const members = getMembers();
            const expenses = getExpenses();
            const now = new Date();
            const currentMonth = now.getMonth() + 1;
            const currentYear = now.getFullYear();

            // Calculate stats
            document.getElementById('totalMembers').textContent = members.length;

            let monthlyCollection = 0;
            members.forEach(member => {
                const payment = member.monthlyPayments.find(
                    p => p.month === currentMonth && p.year === currentYear && p.status === 'paid'
                );
                if (payment) monthlyCollection += 100;
            });

            const currentExpense = expenses.find(e => e.month === currentMonth && e.year === currentYear);
            const monthlyExpenses = currentExpense ? currentExpense.totalExpense : 0;
            const netBalance = monthlyCollection - monthlyExpenses;

            document.getElementById('monthlyCollection').textContent = monthlyCollection;
            document.getElementById('monthlyExpenses').textContent = monthlyExpenses;
            document.getElementById('netBalance').textContent = netBalance;

            // Load charts
            loadCharts(members, expenses);
        }

        function loadCharts(members, expenses) {
            const labels = [];
            const collectionData = [];
            const expenseData = [];

            for (let i = 5; i >= 0; i--) {
                const date = new Date();
                date.setMonth(date.getMonth() - i);
                const month = date.getMonth() + 1;
                const year = date.getFullYear();

                labels.push(monthNames[month].substring(0, 3));

                // Calculate collection
                let collection = 0;
                members.forEach(member => {
                    const payment = member.monthlyPayments.find(
                        p => p.month === month && p.year === year && p.status === 'paid'
                    );
                    if (payment) collection += 100;
                });
                collectionData.push(collection);

                // Get expense
                const expense = expenses.find(e => e.month === month && e.year === year);
                expenseData.push(expense ? expense.totalExpense : 0);
            }

            // Collection Chart
            const collectionCtx = document.getElementById('collectionChart').getContext('2d');
            if (collectionChart) collectionChart.destroy();
            collectionChart = new Chart(collectionCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Collections (₹)',
                        data: collectionData,
                        borderColor: '#ff6b00',
                        backgroundColor: 'rgba(255, 107, 0, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { labels: { color: '#fff' } } },
                    scales: {
                        y: { beginAtZero: true, ticks: { color: '#fff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                        x: { ticks: { color: '#fff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                    }
                }
            });

            // Expense Chart
            const expenseCtx = document.getElementById('expenseChart').getContext('2d');
            if (expenseChart) expenseChart.destroy();
            expenseChart = new Chart(expenseCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Expenses (₹)',
                        data: expenseData,
                        backgroundColor: 'rgba(239, 68, 68, 0.8)',
                        borderColor: '#ef4444',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { labels: { color: '#fff' } } },
                    scales: {
                        y: { beginAtZero: true, ticks: { color: '#fff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                        x: { ticks: { color: '#fff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                    }
                }
            });
        }

        function setupAdminEventListeners() {
            // Sidebar navigation
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    if (!section) return;

                    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');

                    document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
                    document.getElementById(section + 'Section').classList.remove('hidden');

                    switch(section) {
                        case 'dashboard': loadDashboardStats(); break;
                        case 'members': loadMembersTable(); break;
                        case 'payments': loadPayments(); break;
                        case 'expenses': loadExpenses_Admin(); break;
                    }
                });
            });

            // Mobile menu
            document.getElementById('menuToggle').addEventListener('click', () => {
                document.getElementById('sidebar').classList.toggle('open');
            });

            // Modals
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('show'));
                });
            });

            // Members
            document.getElementById('addMemberBtn').addEventListener('click', () => {
                document.getElementById('addMemberModal').classList.add('show');
            });

            document.getElementById('addMemberForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const memberId = document.getElementById('newMemberId').value;
                const memberName = document.getElementById('newMemberName').value;
                const password = document.getElementById('newMemberPassword').value;
                const role = document.getElementById('newMemberRole').value;

                const members = getMembers();
                if (members.find(m => m.memberId === memberId)) {
                    alert('Member ID already exists!');
                    return;
                }

                members.push({
                    memberId,
                    memberName,
                    password,
                    role,
                    monthlyPayments: [],
                    createdAt: new Date().toISOString()
                });

                setMembers(members);
                document.getElementById('addMemberModal').classList.remove('show');
                document.getElementById('addMemberForm').reset();
                loadMembersTable();
                alert('Member added successfully!');
            });

            document.getElementById('searchMember').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                document.querySelectorAll('#membersTableBody tr').forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            });

            // Payments
            document.getElementById('paymentMonth').addEventListener('change', loadPayments);
            document.getElementById('paymentYear').addEventListener('change', loadPayments);
            
            document.getElementById('markAllPaidBtn').addEventListener('click', () => {
                document.querySelectorAll('.payment-checkbox').forEach(cb => cb.checked = true);
            });

            document.getElementById('markAllUnpaidBtn').addEventListener('click', () => {
                document.querySelectorAll('.payment-checkbox').forEach(cb => cb.checked = false);
            });

            document.getElementById('savePaymentsBtn').addEventListener('click', savePayments);

            // Expenses
            document.getElementById('addExpenseBtn').addEventListener('click', () => {
                document.getElementById('addExpenseModal').classList.add('show');
            });

            document.getElementById('addExpenseForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const month = parseInt(document.getElementById('expenseMonth').value);
                const year = parseInt(document.getElementById('expenseYear').value);
                const electricityBill = parseFloat(document.getElementById('electricityBill').value) || 0;
                const internetBill = parseFloat(document.getElementById('internetBill').value) || 0;
                const miscellaneous = parseFloat(document.getElementById('miscellaneousBill').value) || 0;

                const expenses = getExpenses();
                if (expenses.find(e => e.month === month && e.year === year)) {
                    alert('Expense for this month already exists!');
                    return;
                }

                const totalExpense = electricityBill + internetBill + miscellaneous;
                expenses.push({
                    id: Date.now(),
                    month,
                    year,
                    electricityBill,
                    internetBill,
                    miscellaneous,
                    totalExpense,
                    createdAt: new Date().toISOString()
                });

                setExpenses(expenses);
                document.getElementById('addExpenseModal').classList.remove('show');
                document.getElementById('addExpenseForm').reset();
                loadExpenses_Admin();
                alert('Expense added successfully!');
            });

            // Reports
            document.getElementById('viewReportBtn').addEventListener('click', viewReport);
            document.getElementById('downloadReportBtn').addEventListener('click', downloadReport);
            document.getElementById('printMembersReportBtn').addEventListener('click', printMembersReport);

            // Settings
            document.getElementById('changePasswordForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (newPassword !== confirmPassword) {
                    alert('New passwords do not match!');
                    return;
                }

                const user = getCurrentUser();
                const members = getMembers();
                const member = members.find(m => m.memberId === user.memberId);

                if (member.password !== currentPassword) {
                    alert('Current password is incorrect!');
                    return;
                }

                member.password = newPassword;
                setMembers(members);
                document.getElementById('changePasswordForm').reset();
                alert('Password changed successfully!');
            });
        }

        function loadMembersTable() {
            const members = getMembers();
            const tbody = document.getElementById('membersTableBody');
            tbody.innerHTML = '';

            members.forEach(member => {
                const row = document.createElement('tr');
                row.className = 'table-row border-b border-gray-800';
                row.innerHTML = `
                    <td class="py-3 px-4 text-white">${member.memberId}</td>
                    <td class="py-3 px-4 text-white">${member.memberName}</td>
                    <td class="py-3 px-4">
                        <span class="px-3 py-1 rounded-full text-xs font-semibold ${member.role === 'admin' ? 'bg-orange-900 text-orange-200' : 'bg-blue-900 text-blue-200'}">
                            ${member.role.toUpperCase()}
                        </span>
                    </td>
                    <td class="py-3 px-4 text-gray-400">${new Date(member.createdAt).toLocaleDateString()}</td>
                    <td class="py-3 px-4 text-center">
                        <button onclick="deleteMember('${member.memberId}')" class="text-red-400 hover:text-red-300">
                            <svg class="w-5 h-5 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function deleteMember(memberId) {
            if (memberId === 'brahmastra01') {
                alert('Cannot delete main admin!');
                return;
            }

            if (confirm('Are you sure you want to delete this member?')) {
                let members = getMembers();
                members = members.filter(m => m.memberId !== memberId);
                setMembers(members);
                loadMembersTable();
                alert('Member deleted successfully!');
            }
        }

        function loadPayments() {
            const month = parseInt(document.getElementById('paymentMonth').value);
            const year = parseInt(document.getElementById('paymentYear').value);
            const members = getMembers();
            const tbody = document.getElementById('paymentsTableBody');
            tbody.innerHTML = '';

            members.forEach(member => {
                const payment = member.monthlyPayments.find(p => p.month === month && p.year === year);
                const status = payment ? payment.status : 'not_paid';

                const row = document.createElement('tr');
                row.className = 'table-row border-b border-gray-800';
                row.innerHTML = `
                    <td class="py-3 px-4 text-white">${member.memberId}</td>
                    <td class="py-3 px-4 text-white">${member.memberName}</td>
                    <td class="py-3 px-4 text-center text-white">₹100</td>
                    <td class="py-3 px-4 text-center">
                        <label class="inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="payment-checkbox" data-member-id="${member.memberId}" ${status === 'paid' ? 'checked' : ''}>
                            <span class="ml-3 text-sm font-medium ${status === 'paid' ? 'text-green-400' : 'text-red-400'}">
                                ${status === 'paid' ? 'Paid' : 'Not Paid'}
                            </span>
                        </label>
                    </td>
                `;
                tbody.appendChild(row);

                // Update label text on checkbox change
                row.querySelector('.payment-checkbox').addEventListener('change', (e) => {
                    const label = e.target.nextElementSibling;
                    if (e.target.checked) {
                        label.textContent = 'Paid';
                        label.className = 'ml-3 text-sm font-medium text-green-400';
                    } else {
                        label.textContent = 'Not Paid';
                        label.className = 'ml-3 text-sm font-medium text-red-400';
                    }
                });
            });
        }

        function savePayments() {
            const month = parseInt(document.getElementById('paymentMonth').value);
            const year = parseInt(document.getElementById('paymentYear').value);
            const members = getMembers();

            document.querySelectorAll('.payment-checkbox').forEach(cb => {
                const memberId = cb.getAttribute('data-member-id');
                const member = members.find(m => m.memberId === memberId);
                
                if (member) {
                    // Remove existing payment for this month/year
                    member.monthlyPayments = member.monthlyPayments.filter(
                        p => !(p.month === month && p.year === year)
                    );

                    // Add new payment
                    member.monthlyPayments.push({
                        month,
                        year,
                        status: cb.checked ? 'paid' : 'not_paid',
                        amount: 100,
                        paidDate: cb.checked ? new Date().toISOString() : null
                    });
                }
            });

            setMembers(members);
            alert('Payments updated successfully!');
            loadDashboardStats();
        }

        function loadExpenses_Admin() {
            const expenses = getExpenses();
            const tbody = document.getElementById('expensesTableBody');
            tbody.innerHTML = '';

            expenses.sort((a, b) => {
                if (b.year !== a.year) return b.year - a.year;
                return b.month - a.month;
            });

            expenses.forEach(expense => {
                const row = document.createElement('tr');
                row.className = 'table-row border-b border-gray-800';
                row.innerHTML = `
                    <td class="py-3 px-4 text-white">${monthNames[expense.month]} ${expense.year}</td>
                    <td class="py-3 px-4 text-center text-white">₹${expense.electricityBill}</td>
                    <td class="py-3 px-4 text-center text-white">₹${expense.internetBill}</td>
                    <td class="py-3 px-4 text-center text-white">₹${expense.miscellaneous}</td>
                    <td class="py-3 px-4 text-center text-green-400 font-semibold">₹${expense.totalExpense}</td>
                    <td class="py-3 px-4 text-center">
                        <button onclick="deleteExpense(${expense.id})" class="text-red-400 hover:text-red-300">
                            <svg class="w-5 h-5 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function deleteExpense(expenseId) {
            if (confirm('Are you sure you want to delete this expense?')) {
                let expenses = getExpenses();
                expenses = expenses.filter(e => e.id !== expenseId);
                setExpenses(expenses);
                loadExpenses_Admin();
                alert('Expense deleted successfully!');
            }
        }

        function viewReport() {
            const month = parseInt(document.getElementById('reportMonth').value);
            const year = parseInt(document.getElementById('reportYear').value);
            const members = getMembers();
            const expenses = getExpenses();

            let totalCollection = 0;
            let paidMembers = 0;
            let unpaidMembers = 0;

            members.forEach(member => {
                const payment = member.monthlyPayments.find(p => p.month === month && p.year === year);
                if (payment && payment.status === 'paid') {
                    totalCollection += 100;
                    paidMembers++;
                } else {
                    unpaidMembers++;
                }
            });

            const expense = expenses.find(e => e.month === month && e.year === year);
            const totalExpenses = expense ? expense.totalExpense : 0;
            const netBalance = totalCollection - totalExpenses;

            const content = document.getElementById('reportContent');
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl font-bold text-white">Monthly Report</h3>
                        <p class="text-orange-400">${monthNames[month]} ${year}</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-green-900/30 p-4 rounded-lg">
                            <p class="text-gray-400 text-sm">Total Collection</p>
                            <p class="text-2xl font-bold text-green-400">₹${totalCollection}</p>
                        </div>
                        <div class="bg-red-900/30 p-4 rounded-lg">
                            <p class="text-gray-400 text-sm">Total Expenses</p>
                            <p class="text-2xl font-bold text-red-400">₹${totalExpenses}</p>
                        </div>
                        <div class="bg-orange-900/30 p-4 rounded-lg">
                            <p class="text-gray-400 text-sm">Net Balance</p>
                            <p class="text-2xl font-bold text-orange-400">₹${netBalance}</p>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-3">Payment Summary</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-800 p-3 rounded">
                                <p class="text-gray-400 text-sm">Paid Members</p>
                                <p class="text-xl font-bold text-white">${paidMembers}</p>
                            </div>
                            <div class="bg-gray-800 p-3 rounded">
                                <p class="text-gray-400 text-sm">Unpaid Members</p>
                                <p class="text-xl font-bold text-white">${unpaidMembers}</p>
                            </div>
                        </div>
                    </div>
                    
                    ${expense ? `
                    <div>
                        <h4 class="text-lg font-semibold text-white mb-3">Expense Breakdown</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center p-2 bg-gray-800 rounded">
                                <span class="text-gray-400">Electricity Bill</span>
                                <span class="text-white font-semibold">₹${expense.electricityBill}</span>
                            </div>
                            <div class="flex justify-between items-center p-2 bg-gray-800 rounded">
                                <span class="text-gray-400">Internet Bill</span>
                                <span class="text-white font-semibold">₹${expense.internetBill}</span>
                            </div>
                            <div class="flex justify-between items-center p-2 bg-gray-800 rounded">
                                <span class="text-gray-400">Miscellaneous</span>
                                <span class="text-white font-semibold">₹${expense.miscellaneous}</span>
                            </div>
                        </div>
                    </div>
                    ` : '<p class="text-gray-400 text-center">No expenses recorded for this month</p>'}
                </div>
            `;
            content.classList.remove('hidden');
        }

        function downloadReport() {
            const month = parseInt(document.getElementById('reportMonth').value);
            const year = parseInt(document.getElementById('reportYear').value);
            const members = getMembers();
            const expenses = getExpenses();

            let totalCollection = 0;
            let paidMembers = 0;
            let unpaidMembers = 0;

            members.forEach(member => {
                const payment = member.monthlyPayments.find(p => p.month === month && p.year === year);
                if (payment && payment.status === 'paid') {
                    totalCollection += 100;
                    paidMembers++;
                } else {
                    unpaidMembers++;
                }
            });

            const expense = expenses.find(e => e.month === month && e.year === year);
            const totalExpenses = expense ? expense.totalExpense : 0;
            const netBalance = totalCollection - totalExpenses;

            // Create PDF using jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(20);
            doc.setTextColor(255, 107, 0);
            doc.text('Brahmastra Arts & Sports Club', 105, 20, { align: 'center' });
            
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 0);
            doc.text('Monthly Report', 105, 30, { align: 'center' });
            doc.text(`${monthNames[month]} ${year}`, 105, 40, { align: 'center' });

            doc.setFontSize(14);
            doc.setTextColor(255, 107, 0);
            doc.text('Financial Summary', 20, 60);
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`Total Collection: ₹${totalCollection}`, 20, 70);
            doc.text(`Total Expenses: ₹${totalExpenses}`, 20, 80);
            doc.text(`Net Balance: ₹${netBalance}`, 20, 90);

            doc.setFontSize(14);
            doc.setTextColor(255, 107, 0);
            doc.text('Payment Summary', 20, 110);
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`Paid Members: ${paidMembers}`, 20, 120);
            doc.text(`Unpaid Members: ${unpaidMembers}`, 20, 130);
            doc.text(`Total Members: ${members.length}`, 20, 140);

            if (expense) {
                doc.setFontSize(14);
                doc.setTextColor(255, 107, 0);
                doc.text('Expense Breakdown', 20, 160);
                
                doc.setFontSize(12);
                doc.setTextColor(0, 0, 0);
                doc.text(`Electricity Bill: ₹${expense.electricityBill}`, 20, 170);
                doc.text(`Internet Bill: ₹${expense.internetBill}`, 20, 180);
                doc.text(`Miscellaneous: ₹${expense.miscellaneous}`, 20, 190);
            }

            doc.save(`report_${month}_${year}.pdf`);
        }

        function printMembersReport() {
            const month = parseInt(document.getElementById('membersReportMonth').value);
            const year = parseInt(document.getElementById('membersReportYear').value);
            const members = getMembers();

            // Calculate payment status for each member
            const memberPayments = members.map(member => {
                const payment = member.monthlyPayments.find(p => p.month === month && p.year === year);
                return {
                    memberId: member.memberId,
                    memberName: member.memberName,
                    status: payment ? payment.status : 'not_paid',
                    amount: 100,
                    paidDate: payment && payment.paidDate ? new Date(payment.paidDate).toLocaleDateString() : '-'
                };
            });

            // Sort by name
            memberPayments.sort((a, b) => a.memberName.localeCompare(b.memberName));

            // Count statistics
            const totalMembers = members.length;
            const paidCount = memberPayments.filter(m => m.status === 'paid').length;
            const unpaidCount = memberPayments.filter(m => m.status === 'not_paid').length;
            const totalCollection = paidCount * 100;

            // Display the report
            const content = document.getElementById('membersReportContent');
            content.innerHTML = `
                <div class="space-y-6 print-area">
                    <div class="text-center mb-6">
                        <h3 class="text-2xl font-bold text-white">All Members Payment Status</h3>
                        <p class="text-orange-400 text-lg">${monthNames[month]} ${year}</p>
                        <p class="text-gray-400 text-sm mt-2">Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-gray-800 p-4 rounded-lg text-center">
                            <p class="text-gray-400 text-sm">Total Members</p>
                            <p class="text-2xl font-bold text-white">${totalMembers}</p>
                        </div>
                        <div class="bg-green-900/30 p-4 rounded-lg text-center">
                            <p class="text-gray-400 text-sm">Paid</p>
                            <p class="text-2xl font-bold text-green-400">${paidCount}</p>
                        </div>
                        <div class="bg-red-900/30 p-4 rounded-lg text-center">
                            <p class="text-gray-400 text-sm">Unpaid</p>
                            <p class="text-2xl font-bold text-red-400">${unpaidCount}</p>
                        </div>
                        <div class="bg-orange-900/30 p-4 rounded-lg text-center">
                            <p class="text-gray-400 text-sm">Collection</p>
                            <p class="text-2xl font-bold text-orange-400">₹${totalCollection}</p>
                        </div>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b-2 border-gray-700">
                                    <th class="text-left py-3 px-4 text-gray-400 font-semibold">#</th>
                                    <th class="text-left py-3 px-4 text-gray-400 font-semibold">Member ID</th>
                                    <th class="text-left py-3 px-4 text-gray-400 font-semibold">Name</th>
                                    <th class="text-center py-3 px-4 text-gray-400 font-semibold">Amount</th>
                                    <th class="text-center py-3 px-4 text-gray-400 font-semibold">Status</th>
                                    <th class="text-center py-3 px-4 text-gray-400 font-semibold">Paid Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${memberPayments.map((member, index) => `
                                    <tr class="border-b border-gray-800">
                                        <td class="py-3 px-4 text-gray-400">${index + 1}</td>
                                        <td class="py-3 px-4 text-white">${member.memberId}</td>
                                        <td class="py-3 px-4 text-white">${member.memberName}</td>
                                        <td class="py-3 px-4 text-center text-white">₹${member.amount}</td>
                                        <td class="py-3 px-4 text-center">
                                            <span class="px-3 py-1 rounded-full text-xs font-semibold ${member.status === 'paid' ? 'status-paid' : 'status-unpaid'}">
                                                ${member.status === 'paid' ? 'PAID' : 'NOT PAID'}
                                            </span>
                                        </td>
                                        <td class="py-3 px-4 text-center text-gray-400">${member.paidDate}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div class="flex justify-between items-center mt-6 pt-4 border-t border-gray-700 flex-wrap gap-4">
                        <button onclick="window.print()" class="btn-hover gradient-bg px-6 py-3 rounded-lg text-white font-semibold">
                            🖨️ Print Report
                        </button>
                        <button onclick="downloadMembersPDF()" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg text-white font-semibold">
                            📥 Download as PDF
                        </button>
                    </div>
                </div>
            `;
            
            // Show members report
            content.classList.remove('hidden');

            // Scroll to the report
            content.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function downloadMembersPDF() {
            const month = parseInt(document.getElementById('membersReportMonth').value);
            const year = parseInt(document.getElementById('membersReportYear').value);
            const members = getMembers();

            // Calculate payment status for each member
            const memberPayments = members.map(member => {
                const payment = member.monthlyPayments.find(p => p.month === month && p.year === year);
                return {
                    memberId: member.memberId,
                    memberName: member.memberName,
                    status: payment ? payment.status : 'not_paid',
                    paidDate: payment && payment.paidDate ? new Date(payment.paidDate).toLocaleDateString() : '-'
                };
            });

            // Sort by name
            memberPayments.sort((a, b) => a.memberName.localeCompare(b.memberName));

            const totalMembers = members.length;
            const paidCount = memberPayments.filter(m => m.status === 'paid').length;
            const unpaidCount = memberPayments.filter(m => m.status === 'not_paid').length;
            const totalCollection = paidCount * 100;

            // Create PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Header
            doc.setFontSize(20);
            doc.setTextColor(255, 107, 0);
            doc.text('Brahmastra Arts & Sports Club', 105, 15, { align: 'center' });
            
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.text('All Members Payment Status Report', 105, 25, { align: 'center' });
            doc.text(`${monthNames[month]} ${year}`, 105, 32, { align: 'center' });

            // Summary
            doc.setFontSize(10);
            doc.text(`Total Members: ${totalMembers}`, 20, 45);
            doc.text(`Paid: ${paidCount}`, 70, 45);
            doc.text(`Unpaid: ${unpaidCount}`, 110, 45);
            doc.text(`Total Collection: ₹${totalCollection}`, 150, 45);

            // Table header
            doc.setFillColor(255, 107, 0);
            doc.rect(20, 50, 170, 8, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(9);
            doc.text('#', 22, 55);
            doc.text('Member ID', 30, 55);
            doc.text('Name', 70, 55);
            doc.text('Amount', 125, 55);
            doc.text('Status', 150, 55);
            doc.text('Date', 175, 55);

            // Table rows
            doc.setTextColor(0, 0, 0);
            let yPos = 63;
            memberPayments.forEach((member, index) => {
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 20;
                }

                doc.text((index + 1).toString(), 22, yPos);
                doc.text(member.memberId.substring(0, 12), 30, yPos);
                doc.text(member.memberName.substring(0, 20), 70, yPos);
                doc.text('₹100', 125, yPos);
                doc.text(member.status === 'paid' ? 'PAID' : 'NOT PAID', 150, yPos);
                doc.text(member.paidDate, 175, yPos);
                
                yPos += 7;
            });

            // Footer
            doc.setFontSize(8);
            doc.setTextColor(128, 128, 128);
            doc.text(`Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}`, 105, yPos + 10, { align: 'center' });

            doc.save(`members_report_${month}_${year}.pdf`);
        }

        // ==================== MEMBER DASHBOARD ====================
        
        function initMemberDashboard() {
            const user = getCurrentUser();
            document.getElementById('memberName').textContent = user.memberName;
            document.getElementById('memberIdDisplay').textContent = user.memberId;
            
            populateYears();
            loadMemberPaymentHistory();
            loadMemberExpenses();
            calculateMemberStats();
            setupMemberEventListeners();
        }

        function setupMemberEventListeners() {
            document.getElementById('memberFilterYear').addEventListener('change', loadMemberPaymentHistory);
            document.getElementById('memberExpenseFilterYear').addEventListener('change', loadMemberExpenses);

            document.getElementById('memberSettingsBtn').addEventListener('click', () => {
                document.getElementById('memberSettingsModal').classList.add('show');
            });

            document.getElementById('closeMemberSettingsBtn').addEventListener('click', () => {
                document.getElementById('memberSettingsModal').classList.remove('show');
            });

            document.getElementById('memberChangePasswordForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const currentPassword = document.getElementById('memberCurrentPassword').value;
                const newPassword = document.getElementById('memberNewPassword').value;
                const confirmPassword = document.getElementById('memberConfirmPassword').value;

                if (newPassword !== confirmPassword) {
                    alert('New passwords do not match!');
                    return;
                }

                const user = getCurrentUser();
                const members = getMembers();
                const member = members.find(m => m.memberId === user.memberId);

                if (member.password !== currentPassword) {
                    alert('Current password is incorrect!');
                    return;
                }

                member.password = newPassword;
                setMembers(members);
                document.getElementById('memberChangePasswordForm').reset();
                document.getElementById('memberSettingsModal').classList.remove('show');
                alert('Password changed successfully!');
            });
        }

        function loadMemberPaymentHistory() {
            const user = getCurrentUser();
            const year = document.getElementById('memberFilterYear').value;
            const members = getMembers();
            const member = members.find(m => m.memberId === user.memberId);
            const tbody = document.getElementById('memberPaymentHistoryBody');
            tbody.innerHTML = '';

            if (!member) return;

            let payments = member.monthlyPayments;
            if (year !== 'all') {
                payments = payments.filter(p => p.year === parseInt(year));
            }

            payments.sort((a, b) => {
                if (b.year !== a.year) return b.year - a.year;
                return b.month - a.month;
            });

            if (payments.length > 0) {
                payments.forEach(payment => {
                    const row = document.createElement('tr');
                    row.className = 'border-b border-gray-800 hover:bg-gray-900/50 transition';
                    const isPaid = payment.status === 'paid';

                    row.innerHTML = `
                        <td class="py-3 px-4 text-white">${monthNames[payment.month]}</td>
                        <td class="py-3 px-4 text-white">${payment.year}</td>
                        <td class="py-3 px-4 text-center text-white">₹${payment.amount || 100}</td>
                        <td class="py-3 px-4 text-center">
                            <span class="px-3 py-1 rounded-full text-xs font-semibold ${isPaid ? 'status-paid' : 'status-unpaid'}">
                                ${isPaid ? 'Paid' : 'Not Paid'}
                            </span>
                        </td>
                        <td class="py-3 px-4 text-center text-gray-400">
                            ${payment.paidDate ? new Date(payment.paidDate).toLocaleDateString() : '-'}
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            } else {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center py-6 text-gray-400">No payment history found</td></tr>';
            }
        }

        function loadMemberExpenses() {
            const year = document.getElementById('memberExpenseFilterYear').value;
            const expenses = getExpenses();
            const container = document.getElementById('memberExpensesContainer');
            container.innerHTML = '';

            let filteredExpenses = expenses;
            if (year !== 'all') {
                filteredExpenses = expenses.filter(e => e.year === parseInt(year));
            }

            filteredExpenses.sort((a, b) => {
                if (b.year !== a.year) return b.year - a.year;
                return b.month - a.month;
            });

            if (filteredExpenses.length > 0) {
                filteredExpenses.forEach(expense => {
                    const card = document.createElement('div');
                    card.className = 'glass-effect rounded-lg p-6 card-hover';
                    card.innerHTML = `
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-white">${monthNames[expense.month]} ${expense.year}</h3>
                            <div class="w-10 h-10 gradient-bg rounded-full flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <div class="flex justify-between items-center py-2 border-b border-gray-700">
                                <span class="text-gray-400">Electricity</span>
                                <span class="text-white font-semibold">₹${expense.electricityBill || 0}</span>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-gray-700">
                                <span class="text-gray-400">Internet</span>
                                <span class="text-white font-semibold">₹${expense.internetBill || 0}</span>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-gray-700">
                                <span class="text-gray-400">Miscellaneous</span>
                                <span class="text-white font-semibold">₹${expense.miscellaneous || 0}</span>
                            </div>
                            <div class="flex justify-between items-center pt-3">
                                <span class="text-orange-400 font-semibold">Total</span>
                                <span class="text-2xl text-orange-400 font-bold">₹${expense.totalExpense || 0}</span>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            } else {
                container.innerHTML = '<div class="col-span-full text-center py-8 text-gray-400">No expenses recorded for this year</div>';
            }
        }

        function calculateMemberStats() {
            const user = getCurrentUser();
            const members = getMembers();
            const member = members.find(m => m.memberId === user.memberId);

            if (!member) return;

            let totalPaid = 0;
            let pendingDues = 0;

            member.monthlyPayments.forEach(payment => {
                if (payment.status === 'paid') {
                    totalPaid += (payment.amount || 100);
                } else {
                    const paymentDate = new Date(payment.year, payment.month - 1);
                    if (paymentDate < new Date()) {
                        pendingDues += 100;
                    }
                }
            });

            document.getElementById('memberTotalPaid').textContent = `₹${totalPaid}`;
            document.getElementById('memberPendingDues').textContent = `₹${pendingDues}`;
            document.getElementById('memberStatus').textContent = pendingDues === 0 ? 'Active' : 'Dues Pending';
        }

        // ==================== INITIALIZATION ====================
        
        window.addEventListener('load', () => {
            initializeDefaultData();
            
            const user = getCurrentUser();
            if (user) {
                document.getElementById('loginPage').classList.add('hidden');
                if (user.role === 'admin') {
                    document.getElementById('adminDashboard').classList.remove('hidden');
                    initAdminDashboard();
                } else {
                    document.getElementById('memberDashboard').classList.remove('hidden');
                    initMemberDashboard();
                }
            }
        });
    </script>
</body>
</html>
